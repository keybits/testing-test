machine:
  pre:
    - cat ~/.ssh/authorized_keys
  python:
    version: 3.5.1
  php:
    version: 7.0.4
  node:
    version: 6.1.0
#  ruby:
#    version: 2.3.1
  services:
    - elasticsearch
#    - redis
  environment:
    gitHash : $(git rev-parse --short HEAD)


dependencies:
  pre:
    - npm install browserify

test:
  override:
    - case $CIRCLE_NODE_INDEX in 0) nosetests tests/test1.py ;; 1) nosetests tests/test2.py ;; esac:
        parallel: true
  post:
    - echo $CIRCLE_NODE_INDEX:
        parallel: true
    - set |grep CIRCLE
    - touch $CIRCLE_ARTIFACTS/file.txt
    - echo $gitHash

deployment:
  production:
    branch: master
    commands:
      - "true"
